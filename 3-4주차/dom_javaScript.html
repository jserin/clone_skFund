<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3-4주차</title>
    <style>
        #select-table {
            display: none;
        }
    </style>
</head>
<body>
    <div id="select-table">
        <div class="m-bigsize m-bigleft">
            <div><span>투자유형</span></div>
            <div><img src="/img/Common/depth_off.gif" alt="펀드"></div>
            <div><span>증권</span></div>
            <div><span>주식파생형</span></div>
        </div>
        <div id="inner-row">
            <div class="m-smallsize m-small1">
                <div alt="aaaa"><span>6개월 수익률</span></div>
                <div><span>6.88 %</span></div>
            </div>
        </div>
        <div class="m-smallsize m-small2">
            <div><span>기준가</span></div>
            <div><span>1,053.40</span></div>
            <div><span>▲1.04</span></div>
        </div>
    </div>
    <!-- 검색 화면 -->
    <div class="node-search">
        <div class="box">
            <div class="one">
                <div><img src="/img/Common/depth_off.gif" alt="펀드" style="display: none;"></div>
                <span>id</span>
                <input type="text" id="inputId" >
            </div>
            <div class="two">
                <span>노드명</span>
                <input type="text" id="inputNode">
            </div>
            <div class="three">
                <span>속성명</span>
                <input type="text" id="inputName">
            </div>
            <div class="four">
                <span>속성값</span>
                <input type="text" id="inputData">
            </div>
        </div>
        <button id="javaScript">검색(JavaScript)</button>
        <div id="javaScriptResult"></div>
    </div>
    <script>
        let javaScriptBtn = document.getElementById('javaScript');
        let boundary = document.body;
        let result = 0;

        // 버튼클릭이벤트
        javaScriptBtn.addEventListener("click", () => {
            const inputId = document.getElementById("inputId");
            const inputNode = document.getElementById("inputNode");
            const inputName = document.getElementById("inputName");
            const inputData = document.getElementById("inputData");
            boundary = document.body;
            result = 0;
            count = 0;

            // result = test(boundary);
            test(boundary);

            document.getElementById("javaScriptResult").innerHTML = "결과: JavaScript " + result;
        });


        // 공통
        function commonFunc(boundary, condition) {
            let num = 0;
            if ( boundary.childElementCount == 0 ) { return num; }
            for (let i = 0; i < boundary.childElementCount; i++ ) {
                num += condition(boundary.children[i]);
                num += commonFunc(boundary.children[i], condition);
            }
            return num;
        }


        // 찾기 
        // function find(boundary) {
        //     let num = 0;
        //     if ( inputId.value != "" && document.getElementById(inputId.value) == null ) {
        //         return num;
        //     } else if ( inputNode.value == "" && inputName.value == "" && inputData.value == "" ) {
        //         return num = 1;
        //     } else {
        //         boundary = inputId.value == "" ? boundary : document.getElementById(inputId.value);
        //         num += commonFunc(boundary, function(condition1) {
        //         // 노드명이 없으면 속성명 검색으로 이동
        //             if ( inputNode.value == "" ) {
        //                 // 속성명 있으면 속성명 검색, 없으면 속성값 검색
        //                 return inputName.value == "" ? findAttData(condition1) : findAttNm(condition1);
        //             } else {
        //                 // 노드명이 있으면 노드명 검색 시작
        //                 return findNodeNm(condition1);
        //             }
        //         })
        //         console.log("test2 : " + num)
        //     }
        //     return num;
        // }

        function find(boundary) {
            let num = 0;
            num += commonFunc(boundary, (condition1) => {
                console.log(condition1);
                if ( inputData.value != "" ) {
                    
                }
                return num;
            })
            console.log("test2 : " + num)
            
            return num;
        }

        function findNodeNm(boundary) {
            if ( boundary.tagName == inputNode.value.toUpperCase()) {
                return inputName.value != "" ? findAttNm(boundary) : 1;
            }
            return 0;
        }

        // 노드명 찾기
        // function findNodeNm(boundary) {
        //     if ( boundary.tagName == inputNode.value.toUpperCase()) {
        //         if ( inputName.value != "" ) {
        //             // 노드명 안의 속성명 찾기
        //             return findAttNm(boundary);
        //         } else if (inputData.value != "" ) {
        //             return findAttData(boundary);
        //         }
        //         // 속성명 입력 없으면 노드명으로만 검색
        //         return 1;
        //     }
        //     return 0;
        // }

        // 속성명 찾기 
        function findAttNm(boundary) {
            let attNMCount = 0;
            for (let i = 0; i < boundary.attributes.length; i ++) {
                if (boundary.attributes[i].nodeName == inputName.value) {
                    attNMCount++;
                    return inputData.value != "" ? findAttData(boundary) : attNMCount;
                }
            }
            return attNMCount;
        }
        
        // 속성값으로 찾기 속성명 있을때/ 없을때
        function findAttData(boundary) {
            let attDataCount = 0;
            for (let i = 0; i < boundary.attributes.length; i ++) {
                if (boundary.attributes[i].nodeValue.includes(inputData.value) ) {
                    attDataCount++;
                }
            }
            return attDataCount;
        }


        
        function test(boundary) {
            let num = 0;
            if (document.getElementById(inputId.value) || inputId.value == "" ) {
                boundary = inputId.value == "" ? boundary : document.getElementById(inputId.value);
                num = find(boundary);
                return num;
                console.log("ddd");
            } else {
                return 0;
            }
        }

    </script>
</body>
</html>



